\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}

\usepackage[round]{natbib}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}

\newcommand{\String}{\mathsf{String}}
\newcommand{\Real}{\ensuremath{\mathbb{R}}}
\newcommand{\Bool}{\ensuremath{\mathbb{B}}}


\hypersetup{
bookmarks=true,     % show bookmarks bar?
colorlinks=true,       % false: boxed links; true: colored links
linkcolor=red,          % color of internal links (change box color with linkbordercolor)
citecolor=blue,      % color of links to bibliography
filecolor=magenta,  % color of file links
urlcolor=cyan          % color of external links
}

\usepackage{array}

\externaldocument{../../SRS/SRS}

\input{../../Comments}
\input{../../Common}

\begin{document}

\title{Module Interface Specification for \progname{}}

\author{\authname}

\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
Date 1 & 1.0 & Notes\\
Date 2 & 1.1 & Notes\\
\bottomrule
\end{tabularx}

~\newpage

\section{Symbols, Abbreviations and Acronyms}

See SRS Documentation at \wss{give url}

\wss{Also add any additional symbols, abbreviations or acronyms}

\newpage

\tableofcontents

\newpage

\pagenumbering{arabic}

\section{Introduction}

The following document details the Module Interface Specifications for
\wss{Fill in your project name and description}

Complementary documents include the System Requirement Specifications
and Module Guide.  The full documentation and implementation can be
found at \url{...}.  \wss{provide the url for your repo}

\section{Notation}

\wss{You should describe your notation.  You can use what is below as
  a starting point.}

The structure of the MIS for modules comes from \citet{HoffmanAndStrooper1995},
with the addition that template modules have been adapted from
\cite{GhezziEtAl2003}.  The mathematical notation comes from Chapter 3 of
\citet{HoffmanAndStrooper1995}.  For instance, the symbol := is used for a
multiple assignment statement and conditional rules follow the form $(c_1
\Rightarrow r_1 | c_2 \Rightarrow r_2 | ... | c_n \Rightarrow r_n )$.

The following table summarizes the primitive data types used by \progname. 

\begin{center}
\renewcommand{\arraystretch}{1.2}
\noindent 
\begin{tabular}{l l p{7.5cm}} 
\toprule 
\textbf{Data Type} & \textbf{Notation} & \textbf{Description}\\ 
\midrule
character & char & a single symbol or digit\\
integer & $\mathbb{Z}$ & a number without a fractional component in (-$\infty$, $\infty$) \\
natural number & $\mathbb{N}$ & a number without a fractional component in [1, $\infty$) \\
real & $\mathbb{R}$ & any number in (-$\infty$, $\infty$)\\
\bottomrule
\end{tabular} 
\end{center}

\noindent
The specification of \progname \ uses some derived data types: sequences, strings, and
tuples. Sequences are lists filled with elements of the same data type. Strings
are sequences of characters. Tuples contain a list of values, potentially of
different types. In addition, \progname \ uses functions, which
are defined by the data types of their inputs and outputs. Local functions are
described by giving their type signature followed by their specification.

\section{Module Decomposition}

The following table is taken directly from the Module Guide document for this project.

\begin{table}[h!]
\centering
\begin{tabular}{p{0.3\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Level 1} & \textbf{Level 2}\\
\midrule

{Hardware-Hiding} & ~ \\
\midrule

\multirow{7}{0.3\textwidth}{Behaviour-Hiding} & Input Parameters\\
& Output Format\\
& Output Verification\\
& Temperature ODEs\\
& Energy Equations\\ 
& Control Module\\
& Specification Parameters Module\\
\midrule

\multirow{3}{0.3\textwidth}{Software Decision} & {Sequence Data Structure}\\
& ODE Solver\\
& Plotting\\
\bottomrule

\end{tabular}
\caption{Module Hierarchy}
\label{TblMH}
\end{table}

\newpage
~\newpage

\section{MIS of Backend Controller} \label{Module} \wss{Use labels for
  cross-referencing}

\wss{You can reference SRS labels, such as R\ref{R_Inputs}.}

\wss{It is also possible to use \LaTeX for hypperlinks to external documents.}

\subsection{Module}

\texttt{BackendController}

\subsection{Uses}
Serves as the coordinator between the frontend, backend and machine learning modules. 
\begin{itemize}
  \item Forwards frontend requests to the appropriate backend modules, such authentication or image validation.
  \item Sends validated inputs to the ML Model for alt-text generation. 
  \item Retrieves generated alt-text and returns it to the frontend modules. 
\end{itemize}


\subsection{Syntax}

\subsubsection{Exported Constants}
\texttt{SESSION\_TIMEOUT}: $\mathbb{N}$ - Specifies the amount of time in minutes a users logged-in session can remain active for before requiring reauthentication.\\ \\
\texttt{API\_RESPONSE\_TIMEOUT}: $\mathbb{N}$ - Specifies the amount of time in seconds that the controller waits for a response from other modules before timing out.\\

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{3cm} p{4cm} p{3cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
validateUser & userToken & Boolean & InvalidTokenException \\
\hline
validateImage & image, userToken & Boolean & InvalidImageException\\
\hline
sendToModel & image, userToken & None & AltTextGenerationError\\
\hline 
getAltText & image, userToken & altText & AltTextNotFoundException\\
\hline 
returnToFrontend & altText or errorMsg, userID & None& FrontendUnreachableException \\
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\wss{Not all modules will have state variables.  State variables give the module
  a memory.}

\subsubsection{Environment Variables}

\wss{This section is not necessary for all modules.  Its purpose is to capture
  when the module has external interaction with the environment, such as for a
  device driver, screen interface, keyboard, file, etc.}
  \begin{itemize}
    \item Frontend Modules: Receives user requests such as image uploads and returns responses such alt-text generation or error messages.
    \item User Authentication Modules: Sends the user's session token to module to verify users identity. 
    \item Image Validation Modules: Sends the user's inputted image to be confirm it meets the required format and size, prior to alt-text generation.
    \item Machine Learning Modules: Sends users validated image to ML model to begin alt text generation.
  \end{itemize}

\subsubsection{Assumptions}

\wss{Try to minimize assumptions and anticipate programmer errors via
  exceptions, but for practical purposes assumptions are sometimes appropriate.}
\begin{itemize}
  \item Frontend, User authentication, Image validation and machine learning modules are correctly operating and reachable. 
  \item Network connection is available for API communication. 
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent \texttt{validateUser(userToken)}:
\begin{itemize}
\item transition: Sends the \texttt{userToken} to the User Authentication Module for Verification.
\item output: Returns \texttt{True} if the user is valid, otherwise \texttt{False} is returned.
\item exception: \texttt{InvalidTokenException} is raised if token is expired or cannot be validated. 
\end{itemize}



\noindent \texttt{validateImage(image,userToken)}:
\begin{itemize}
\item transition: Sends the uploaded image and associated user token to the Image Validation Module for verification of file type and size.
\item output:  Returns \texttt{True} if the image was successfully validated, otherwise \texttt{False} is returned.
\item exception:  \texttt{InvalidImageException} is raised if the image fails the validation process and does not meet system requirements.
\end{itemize}



\noindent \texttt{sendToModel(image,userToken)}:
\begin{itemize}
\item transition: Sends the validated image and associated user token to the Machine Learning Module to initiate alt-text generation.  
\item output:  None
\item exception: \texttt{AltTextGenerationError} is raised if the Machine Learning Module fails to process image or generate alt text. 
\end{itemize}


\noindent \texttt{returnToFrontend(alt Text or errorMsg, userToken)}:
\begin{itemize}
\item transition: Sends the generated alt text or corresponding error message to the Frontend Module. 
\item output:  None
\item exception: \texttt{FrontendUnreachableException} is raised if the Frontend Module cannot be reached. 
\end{itemize}





\wss{A module without environment variables or state variables is unlikely to
  have a state transition.  In this case a state transition can only occur if
  the module is changing the state of another module.}

\wss{Modules rarely have both a transition and an output.  In most cases you
  will have one or the other.}

\subsubsection{Local Functions}

\wss{As appropriate} \wss{These functions are for the purpose of specification.
  They are not necessarily something that is going to be implemented
  explicitly.  Even if they are implemented, they are not exported; they only
  have local scope.}


\section{MIS of User Interface Interactions Module}\label{UI_Interactions} \wss{Use labels for
cross-referencing}

\wss{You can reference SRS labels, such as R\ref{R_Inputs}.}

\wss{It is also possible to use \LaTeX for hypperlinks to external documents.}

\subsection{Module}

interactionsUI

\subsection{Uses}
[this is from other modules]

\subsection{Syntax}

\subsubsection{Exported Constants}

\texttt{SUPPORTED\_IMG\_TYPES = \{"PNG", "JPEG"\}}\\
\texttt{OUTPUT\_FILE\_TYPE = \{".txt"\}}\\
\texttt{MAX\_IMG\_SIZE = 10MB}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2.5cm} p{4cm} p{4cm} p{3cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
uploadImage & imageFilePath:String & Success:\Bool & FileNotFound, FileTypeNotSupported, FileTooLarge\\
downloadText & altText:String & altTextFile:String & NetworkError \\
copyText & altText:String & Success:\Bool & ClipboardError \\
editText & altText:String, editedText:String & Success:\Bool & NetworkError \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\wss{Not all modules will have state variables.  State variables give the module
  a memory.} \\ 

None

\subsubsection{Environment Variables}

\wss{This section is not necessary for all modules.  Its purpose is to capture
  when the module has external interaction with the environment, such as for a
  device driver, screen interface, keyboard, file, etc.} 

\begin{itemize}
  \item Clipboard - system's clipboard interface for copy function.
  \item HTTPClient - used to call backend services.
  \item Keyboard - receives key presses for keyboard navigation. 
\end{itemize}


\subsubsection{Assumptions}

\wss{Try to minimize assumptions and anticipate programmer errors via
  exceptions, but for practical purposes assumptions are sometimes appropriate.} 
  
  \begin{itemize}
    \item Clipboard access is enabled by the user for \texttt{copyText}.
    \item User allows system to access files for uploading images and downloading alt text. 
    \item \texttt{uploadImage} is called before any other access program.
  \end{itemize}


\subsubsection{Access Routine Semantics}

\noindent \textbf{uploadImage(imageFilePath)}:
\begin{itemize}
\item transition: \texttt{HTTPClient} sends the image bytes into the backend service which stores the image for that session, and communicates 
with the AI model for alt text generation. 
\item output: returns \texttt{true} iff the backend server acknowledges and is able to process the image.
\item exception: FileNotFound, FileTypeNotSupported (not in \texttt{SUPPORT\_IMG\_TYPES}), and FileTooLarge (not within \texttt{MAX\_IMG\_SIZE})
\end{itemize}

\noindent \textbf{downloadText(altText)}:
\begin{itemize}
\item transition: None (read-only fetch).
\item output: a \texttt{.txt} payload that contains the generated alt text. 
\item exception: NetworkError.
\end{itemize}

\noindent \textbf{copyText(altText)}:
\begin{itemize} 
\item transition: Clipboard := altText
\item output: returns \texttt{true} iff clipboard write succeeds. 
\item exception: ClipboardError.
\end{itemize}

\noindent \textbf{editText(altText,editedText)}:
\begin{itemize}
\item transition: \texttt{HTTPClient} sends update to backend and stored altText for uploaded image is replaced with editedText.
\item output: return \texttt{true} iff server acknowledges the update.
\item exception: NetworkError.
\end{itemize}

\wss{A module without environment variables or state variables is unlikely to
  have a state transition.  In this case a state transition can only occur if
  the module is changing the state of another module.}

\wss{Modules rarely have both a transition and an output.  In most cases you
  will have one or the other.}

\subsubsection{Local Functions}
\wss{As appropriate} \wss{These functions are for the purpose of specification.
  They are not necessarily something that is going to be implemented
  explicitly.  Even if they are implemented, they are not exported; they only
  have local scope.} 
\begin{itemize}
  \item \textbf{isSupportedImage(filePath:String) \texttt{->} \Bool}: returns \texttt{true} if 
  the file type $\in$ \texttt{SUPPORTED\_IMG\_TYPES}.
  \item \textbf{checkImgSize(filePath:String) \texttt{->} \Bool}: returns \texttt{true} if 
  the size of the image $\le$ \texttt{MAX\_IMG\_SIZE}.
  \item \textbf{saveAsTxt(altText: String) \texttt{->} filePath:String}: wraps generated alt text
   into a \texttt{.txt} file for \texttt{downloadText()}.
  \item \textbf{buildUploadPayload(filePath: String) \texttt{->} Binary (?)}: reads the file and constructs the binary payload for the 
  \texttt{uploadImage} function. 
\end{itemize}


\section{MIS of User Interface Display Module}\label{UI_display} \wss{Use labels for
cross-referencing}

\wss{You can reference SRS labels, such as R\ref{R_Inputs}.}

\wss{It is also possible to use \LaTeX for hypperlinks to external documents.}

\subsection{Module}

displayUI

\subsection{Uses}

accessibilityUI\\
interactionsUI

\subsection{Syntax}

\subsubsection{Exported Constants}
None

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2.5cm} p{4cm} p{4cm} p{3cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
renderLogIn & - & - & - \\
showHistory & - & - & - \\
renderMain & - & - & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

None

\subsubsection{Environment Variables}

\texttt{DOM} - active document element into which UI is rendered.\\

\subsubsection{Assumptions}

\wss{Try to minimize assumptions and anticipate programmer errors via
  exceptions, but for practical purposes assumptions are sometimes appropriate.}

\subsubsection{Access Routine Semantics}


\noindent \textbf{renderLogIn()}:
\begin{itemize}
\item transition: update DOM to reflect log in screen with username and password fields.
\item output: None 
\item exception: None
\end{itemize}

\noindent \textbf{showHistory()}:
\begin{itemize} 
  \item transition: update DOM to reflect user's current session history.
  \item output: None
  \item exception: None
\end{itemize}

\noindent \textbf{renderMain()}:
\begin{itemize}
  \item transition: update DOM to reflect main screen containing the upload page.
  \item output: None
  \item exception: None
\end{itemize}

\wss{A module without environment variables or state variables is unlikely to
  have a state transition.  In this case a state transition can only occur if
  the module is changing the state of another module.}

\wss{Modules rarely have both a transition and an output.  In most cases you
  will have one or the other.}

\subsubsection{Local Functions}

\wss{As appropriate} \wss{These functions are for the purpose of specification.
  They are not necessarily something that is going to be implemented
  explicitly.  Even if they are implemented, they are not exported; they only
  have local scope.}


\section{MIS of User Interface Accessibility Module}\label{UI_accessibility} \wss{Use labels for
  cross-referencing}
  
  \wss{You can reference SRS labels, such as R\ref{R_Inputs}.}
  
  \wss{It is also possible to use \LaTeX for hypperlinks to external documents.}
  
  \subsection{Module}
  
  accessibilityUI
  
  \subsection{Uses}
  None
  \subsection{Syntax}
  
  \subsubsection{Exported Constants}
  
  \subsubsection{Exported Access Programs}
  
  \begin{center}
  \begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
  \hline
  \textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
  \hline
  \wss{accessProg} & - & - & - \\
  \hline
  \end{tabular}
  \end{center}
  
  \subsection{Semantics}
  
  \subsubsection{State Variables}

  None
  
  \subsubsection{Environment Variables}
    \texttt{DOM} - the active HTML document containing interactive elements \\ 
    \texttt{ScreenReaderAPI} - hidden DOM nodes used to deliver announcements to screen readers for compatibility\\
    \texttt{Keyboard} - delivers keypress events to use for keyboard navigation\\
  
  \subsubsection{Assumptions}
  
  \wss{Try to minimize assumptions and anticipate programmer errors via
    exceptions, but for practical purposes assumptions are sometimes appropriate.} \\

    \begin{itemize}
      \item The page allows insertion of valid ARIA live region nodes
      \item \texttt{displayUI} calls \texttt{accessibilityUI} to announce changes rather than using ScreenReader APIs directly
    \end{itemize}
  
  \subsubsection{Access Routine Semantics}
  
  \noindent \wss{accessProg}():
  \begin{itemize}
  \item transition: \wss{if appropriate} 
  \item output: \wss{if appropriate} 
  \item exception: \wss{if appropriate} 
  \end{itemize}
  
  \wss{A module without environment variables or state variables is unlikely to
    have a state transition.  In this case a state transition can only occur if
    the module is changing the state of another module.}
  
  \wss{Modules rarely have both a transition and an output.  In most cases you
    will have one or the other.}
  
  \subsubsection{Local Functions}
  
  \wss{As appropriate} \wss{These functions are for the purpose of specification.
    They are not necessarily something that is going to be implemented
    explicitly.  Even if they are implemented, they are not exported; they only
    have local scope.}

  \newpage

\bibliographystyle {plainnat}
\bibliography {../../../refs/References}

\newpage

\section{Appendix} \label{Appendix}

\wss{Extra information if required}

\newpage{}

\section*{Appendix --- Reflection}

\wss{Not required for CAS 741 projects}

The information in this section will be used to evaluate the team members on the
graduate attribute of Problem Analysis and Design.

\input{../../Reflection.tex}

\begin{enumerate}
  \item What went well while writing this deliverable? 
  \item What pain points did you experience during this deliverable, and how
    did you resolve them?
  \item Which of your design decisions stemmed from speaking to your client(s)
  or a proxy (e.g. your peers, stakeholders, potential users)? For those that
  were not, why, and where did they come from?
  \item While creating the design doc, what parts of your other documents (e.g.
  requirements, hazard analysis, etc), it any, needed to be changed, and why?
  \item What are the limitations of your solution?  Put another way, given
  unlimited resources, what could you do to make the project better? (LO\_ProbSolutions)
  \item Give a brief overview of other design solutions you considered.  What
  are the benefits and tradeoffs of those other designs compared with the chosen
  design?  From all the potential options, why did you select the documented design?
  (LO\_Explores)
\end{enumerate}


\end{document} 