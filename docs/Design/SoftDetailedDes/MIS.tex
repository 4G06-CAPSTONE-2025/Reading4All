\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}

\usepackage[round]{natbib}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}

\hypersetup{
bookmarks=true,     % show bookmarks bar?
colorlinks=true,       % false: boxed links; true: colored links
linkcolor=red,          % color of internal links (change box color with linkbordercolor)
citecolor=blue,      % color of links to bibliography
filecolor=magenta,  % color of file links
urlcolor=cyan          % color of external links
}

\usepackage{array}

\externaldocument{../../SRS/SRS}

\input{../../Comments}
\input{../../Common}

\begin{document}

\title{Module Interface Specification for \progname{}}

\author{\authname}

\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
Date 1 & 1.0 & Notes\\
Date 2 & 1.1 & Notes\\
\bottomrule
\end{tabularx}

~\newpage

\section{Symbols, Abbreviations and Acronyms}

See SRS Documentation at \wss{give url}

\wss{Also add any additional symbols, abbreviations or acronyms}

\newpage

\tableofcontents

\newpage

\pagenumbering{arabic}

\section{Introduction}

The following document details the Module Interface Specifications for
\wss{Fill in your project name and description}

Complementary documents include the System Requirement Specifications
and Module Guide.  The full documentation and implementation can be
found at \url{...}.  \wss{provide the url for your repo}

\section{Notation}

\wss{You should describe your notation.  You can use what is below as
  a starting point.}

The structure of the MIS for modules comes from \citet{HoffmanAndStrooper1995},
with the addition that template modules have been adapted from
\cite{GhezziEtAl2003}.  The mathematical notation comes from Chapter 3 of
\citet{HoffmanAndStrooper1995}.  For instance, the symbol := is used for a
multiple assignment statement and conditional rules follow the form $(c_1
\Rightarrow r_1 | c_2 \Rightarrow r_2 | ... | c_n \Rightarrow r_n )$.

The following table summarizes the primitive data types used by \progname. 

\begin{center}
\renewcommand{\arraystretch}{1.2}
\noindent 
\begin{tabular}{l l p{7.5cm}} 
\toprule 
\textbf{Data Type} & \textbf{Notation} & \textbf{Description}\\ 
\midrule
character & char & a single symbol or digit\\
integer & $\mathbb{Z}$ & a number without a fractional component in (-$\infty$, $\infty$) \\
natural number & $\mathbb{N}$ & a number without a fractional component in [1, $\infty$) \\
real & $\mathbb{R}$ & any number in (-$\infty$, $\infty$)\\
\bottomrule
\end{tabular} 
\end{center}

\noindent
The specification of \progname \ uses some derived data types: sequences, strings, and
tuples. Sequences are lists filled with elements of the same data type. Strings
are sequences of characters. Tuples contain a list of values, potentially of
different types. In addition, \progname \ uses functions, which
are defined by the data types of their inputs and outputs. Local functions are
described by giving their type signature followed by their specification.

\section{Module Decomposition}

The following table is taken directly from the Module Guide document for this project.

\begin{table}[h!]
\centering
\begin{tabular}{p{0.3\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Level 1} & \textbf{Level 2}\\
\midrule

{Hardware-Hiding} & ~ \\
\midrule

\multirow{7}{0.3\textwidth}{Behaviour-Hiding} & Input Parameters\\
& Output Format\\
& Output Verification\\
& Temperature ODEs\\
& Energy Equations\\ 
& Control Module\\
& Specification Parameters Module\\
\midrule

\multirow{3}{0.3\textwidth}{Software Decision} & {Sequence Data Structure}\\
& ODE Solver\\
& Plotting\\
\bottomrule

\end{tabular}
\caption{Module Hierarchy}
\label{TblMH}
\end{table}

\newpage
~\newpage

\section{MIS of Backend Controller} \label{Module} \wss{Use labels for
  cross-referencing}

\wss{You can reference SRS labels, such as R\ref{R_Inputs}.}

\wss{It is also possible to use \LaTeX for hypperlinks to external documents.}

\subsection{Module}

\texttt{BackendController}

\subsection{Uses}
Serves as the coordinator between the frontend, backend and machine learning modules. 
\begin{itemize}
  \item Forwards frontend requests to the appropriate backend modules, such authentication or image validation.
  \item Sends validated inputs to the ML Model for alt-text generation. 
  \item Retrieves generated alt-text and returns it to the frontend modules. 
\end{itemize}


\subsection{Syntax}

\subsubsection{Exported Constants}
\texttt{SESSION\_TIMEOUT}: $\mathbb{N}$ - Specifies the amount of time in minutes a users logged-in session can remain active for before requiring reauthentication.\\ \\
\texttt{API\_RESPONSE\_TIMEOUT}: $\mathbb{N}$ - Specifies the amount of time in seconds that the controller waits for a response from other modules before timing out.\\

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{3cm} p{4cm} p{3cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
validateUser & userToken & Boolean & InvalidTokenException \\
\hline
validateImage & image, userToken & Boolean & InvalidImageException\\
\hline
sendToModel & image, userToken & None & AltTextGenerationError\\
\hline 
getAltText & image, userToken & altText & AltTextNotFoundException\\
\hline 
returnToFrontend & altText or errorMsg, userID & None& FrontendUnreachableException \\
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\wss{Not all modules will have state variables.  State variables give the module
  a memory.}

\subsubsection{Environment Variables}

\wss{This section is not necessary for all modules.  Its purpose is to capture
  when the module has external interaction with the environment, such as for a
  device driver, screen interface, keyboard, file, etc.}
  \begin{itemize}
    \item Frontend Modules: Receives user requests such as image uploads and returns responses such alt-text generation or error messages.
    \item User Authentication Modules: Sends the user's session token to module to verify users identity. 
    \item Image Validation Modules: Sends the user's inputted image to be confirm it meets the required format and size, prior to alt-text generation.
    \item Machine Learning Modules: Sends users validated image to ML model to begin alt text generation.
  \end{itemize}

\subsubsection{Assumptions}

\wss{Try to minimize assumptions and anticipate programmer errors via
  exceptions, but for practical purposes assumptions are sometimes appropriate.}
\begin{itemize}
  \item Frontend, User authentication, Image validation and machine learning modules are correctly operating and reachable. 
  \item Network connection is available for API communication. 
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent \texttt{validateUser(userToken)}:
\begin{itemize}
\item transition: Sends the \texttt{userToken} to the User Authentication Module for Verification.
\item output: Returns \texttt{True} if the user is valid, otherwise \texttt{False} is returned.
\item exception: \texttt{InvalidTokenException} is raised if token is expired or cannot be validated. 
\end{itemize}



\noindent \texttt{validateImage(image,userToken)}:
\begin{itemize}
\item transition: Sends the uploaded image and associated user token to the Image Validation Module for verification of file type and size.
\item output:  Returns \texttt{True} if the image was successfully validated, otherwise \texttt{False} is returned.
\item exception:  \texttt{InvalidImageException} is raised if the image fails the validation process and does not meet system requirements.
\end{itemize}



\noindent \texttt{sendToModel(image,userToken)}:
\begin{itemize}
\item transition: Sends the validated image and associated user token to the Machine Learning Module to initiate alt-text generation.  
\item output:  None
\item exception: \texttt{AltTextGenerationError} is raised if the Machine Learning Module fails to process image or generate alt text. 
\end{itemize}


\noindent \texttt{returnToFrontend(alt Text or errorMsg, userToken)}:
\begin{itemize}
\item transition: Sends the generated alt text or corresponding error message to the Frontend Module. 
\item output:  None
\item exception: \texttt{FrontendUnreachableException} is raised if the Frontend Module cannot be reached. 
\end{itemize}


\newpage
\section{MIS of AIModelTraining Module} \label{aitrain}

\subsection{Module}
AITrain

\subsection{Uses}
Receives preprocessed data from the DataPreprocess module and produces a trained model used by the Classifier/Inference module for alt-text generation.  

\subsection{Syntax}
\subsubsection{Exported Constants}
None.

\subsubsection{Exported Access Programs}

\begin{center}
  \begin{tabular}{p{4cm} p{4cm} p{4cm} p{3cm}}
    \toprule
    \textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
    \midrule
    initializeModel & configPath:\,String & None & ConfigFileNotFoundException \\
    trainModel & datasetSpec:\,DatasetSpec & modelWeights:\,ModelWeights & TrainingException \\
    saveCheckpoint & epoch:\,$\mathbb{N}$, metrics:\,MetricsReport & None & WriteErrorException \\
    evaluateModel & validationSet:\,DatasetSpec & metrics:\,MetricsReport & EvaluationErrorException \\
    \bottomrule
  \end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
  \item trainedModel:\,ModelWeights — stores most recently trained weights.
  \item trainingLogs:\,MetricsLog — records metrics for each epoch.
\end{itemize}

\subsubsection{Environment Variables}
\begin{itemize}
  \item Filesystem — used to read/write checkpoints and logs.
  \item GPU/CPU — executes model computations.
\end{itemize}

\subsubsection{Assumptions}
\begin{itemize}
  \item Dataset inputs are valid and preprocessed.
  \item Sufficient compute (GPU/CPU) resources available.
  \item The configuration file exists and is readable.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent \texttt{initializeModel(configPath)}:
\begin{itemize}
  \item transition: Loads model architecture, optimizer, and training parameters.
  \item output: None.
  \item exception: \texttt{ConfigFileNotFoundException} if file is missing or invalid.
\end{itemize}

\noindent \texttt{trainModel(datasetSpec)}:
\begin{itemize}
  \item transition: Performs training; updates \texttt{trainedModel}.
  \item output: Returns \texttt{ModelWeights}.
  \item exception: \texttt{TrainingException} if training fails or dataset is invalid.
\end{itemize}

\noindent \texttt{saveCheckpoint(epoch, metrics)}:
\begin{itemize}
  \item transition: Saves current weights and metrics to storage.
  \item output: None.
  \item exception: \texttt{WriteErrorException} if write operation fails.
\end{itemize}

\noindent \texttt{evaluateModel(validationSet)}:
\begin{itemize}
  \item transition: Evaluates performance; appends metrics to log.
  \item output: Returns \texttt{MetricsReport}.
  \item exception: \texttt{EvaluationErrorException} if validation set missing or corrupt.
\end{itemize}

\subsubsection{Local Functions}
None.


\newpage
\section{MIS of Classifier / Inference Module} \label{classify}

\subsection{Module}
ClassifierInference

\subsection{Uses}
Uses trained weights from \hyperref[aitrain]{AIModelTraining Module} to generate alt-text descriptions for new images.  

\subsection{Syntax}
\subsubsection{Exported Constants}
None.

\subsubsection{Exported Access Programs}

\begin{center}
  \begin{tabular}{p{4cm} p{4cm} p{4cm} p{3cm}}
    \toprule
    \textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
    \midrule
    loadModel & modelWeights:\,ModelWeights & None & ModelLoadException \\
    predictAltText & image:\,TensorImage & altText:\,AltText & InferenceErrorException \\
    decodeOutput & rawPredictions:\,Logits & altText:\,AltText & DecodeErrorException \\
    getConfidenceScore & altText:\,AltText & confidence:\,$\mathbb{R}$ & None \\
    \bottomrule
  \end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
\begin{itemize}
  \item loadedModel:\,ModelWeights — active weights for inference.
\end{itemize}

\subsubsection{Environment Variables}
\begin{itemize}
  \item GPU/CPU — runs inference computations.
\end{itemize}

\subsubsection{Assumptions}
\begin{itemize}
  \item \texttt{modelWeights} correspond to a valid trained model.
  \item \texttt{image} is preprocessed to expected input dimensions.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent \texttt{loadModel(modelWeights)}:
\begin{itemize}
  \item transition: Loads model weights into memory.
  \item output: None.
  \item exception: \texttt{ModelLoadException} if weights are corrupted or missing.
\end{itemize}

\noindent \texttt{predictAltText(image)}:
\begin{itemize}
  \item transition: Performs inference and generates raw predictions.
  \item output: Returns generated alt text.
  \item exception: \texttt{InferenceErrorException} if computation fails.
\end{itemize}

\noindent \texttt{decodeOutput(rawPredictions)}:
\begin{itemize}
  \item transition: Converts raw outputs into readable descriptions.
  \item output: Returns decoded \texttt{AltText}.
  \item exception: \texttt{DecodeErrorException} if decoding fails.
\end{itemize}

\noindent \texttt{getConfidenceScore(altText)}:
\begin{itemize}
  \item transition: None.
  \item output: Returns confidence score in range [0,1].
  \item exception: None.
\end{itemize}

\subsubsection{Local Functions}
None.



\wss{A module without environment variables or state variables is unlikely to
  have a state transition.  In this case a state transition can only occur if
  the module is changing the state of another module.}

\wss{Modules rarely have both a transition and an output.  In most cases you
  will have one or the other.}

\subsubsection{Local Functions}

\wss{As appropriate} \wss{These functions are for the purpose of specification.
  They are not necessarily something that is going to be implemented
  explicitly.  Even if they are implemented, they are not exported; they only
  have local scope.}

\newpage

\bibliographystyle {plainnat}
\bibliography {../../../refs/References}

\newpage

\section{Appendix} \label{Appendix}

\wss{Extra information if required}

\newpage{}

\section*{Appendix --- Reflection}

\wss{Not required for CAS 741 projects}

The information in this section will be used to evaluate the team members on the
graduate attribute of Problem Analysis and Design.

\input{../../Reflection.tex}

\begin{enumerate}
  \item What went well while writing this deliverable? 
  \item What pain points did you experience during this deliverable, and how
    did you resolve them?
  \item Which of your design decisions stemmed from speaking to your client(s)
  or a proxy (e.g. your peers, stakeholders, potential users)? For those that
  were not, why, and where did they come from?
  \item While creating the design doc, what parts of your other documents (e.g.
  requirements, hazard analysis, etc), it any, needed to be changed, and why?
  \item What are the limitations of your solution?  Put another way, given
  unlimited resources, what could you do to make the project better? (LO\_ProbSolutions)
  \item Give a brief overview of other design solutions you considered.  What
  are the benefits and tradeoffs of those other designs compared with the chosen
  design?  From all the potential options, why did you select the documented design?
  (LO\_Explores)
\end{enumerate}


\end{document}